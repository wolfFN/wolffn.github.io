"use strict";(self.webpackChunkdocusaurus_demo=self.webpackChunkdocusaurus_demo||[]).push([[3861],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var l=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,l,r=function(e,t){if(null==e)return{};var n,l,r={},a=Object.keys(e);for(l=0;l<a.length;l++)n=a[l],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(l=0;l<a.length;l++)n=a[l],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=l.createContext({}),u=function(e){var t=l.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},c=function(e){var t=u(e.components);return l.createElement(i.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return l.createElement(l.Fragment,{},t)}},s=l.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),s=u(n),d=r,f=s["".concat(i,".").concat(d)]||s[d]||m[d]||a;return n?l.createElement(f,p(p({ref:t},c),{},{components:n})):l.createElement(f,p({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,p=new Array(a);p[0]=s;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o.mdxType="string"==typeof e?e:r,p[1]=o;for(var u=2;u<a;u++)p[u]=n[u];return l.createElement.apply(null,p)}return l.createElement.apply(null,n)}s.displayName="MDXCreateElement"},7376:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return i},default:function(){return d},frontMatter:function(){return o},metadata:function(){return u},toc:function(){return m}});var l=n(3117),r=n(102),a=(n(7294),n(3905)),p=["components"],o={title:"FFmpeg"},i=void 0,u={unversionedId:"tools/shell/ffmpeg",id:"tools/shell/ffmpeg",title:"FFmpeg",description:"FFmpeg \u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u3001\u8de8\u5e73\u53f0\u7684\u97f3\u9891\u548c\u89c6\u9891\u5f55\u5236\u3001\u8f6c\u6362\u548c\u6d41\u5a92\u4f53\u89e3\u51b3\u65b9\u6848\u3002",source:"@site/docs/tools/shell/ffmpeg.md",sourceDirName:"tools/shell",slug:"/tools/shell/ffmpeg",permalink:"/docs/tools/shell/ffmpeg",draft:!1,tags:[],version:"current",frontMatter:{title:"FFmpeg"},sidebar:"tools",previous:{title:"uniq",permalink:"/docs/tools/shell/uniq"},next:{title:"\u7cfb\u7edf\u8bbe\u7f6e",permalink:"/docs/tools/mac/system"}},c={},m=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528",level:2},{value:"\u67e5\u770b\u89c6\u9891\u7f16\u7801",id:"\u67e5\u770b\u89c6\u9891\u7f16\u7801",level:2},{value:"\u5c06\u89c6\u9891\u8f6c\u5316\u4e3a h265 \u7f16\u7801",id:"\u5c06\u89c6\u9891\u8f6c\u5316\u4e3a-h265-\u7f16\u7801",level:2},{value:"\u65f6\u95f4",id:"\u65f6\u95f4",level:2},{value:"\u89e3\u538b\u7f29\u89c6\u9891",id:"\u89e3\u538b\u7f29\u89c6\u9891",level:2},{value:"\u8c03\u6574\u5206\u8fa8\u7387",id:"\u8c03\u6574\u5206\u8fa8\u7387",level:2},{value:"\u89c6\u9891\u5904\u7406",id:"\u89c6\u9891\u5904\u7406",level:2},{value:"\u4f7f\u7528\u663e\u5361\u5904\u7406",id:"\u4f7f\u7528\u663e\u5361\u5904\u7406",level:2}],s={toc:m};function d(e){var t=e.components,n=(0,r.Z)(e,p);return(0,a.kt)("wrapper",(0,l.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://ffmpeg.org/"},"FFmpeg")," \u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u3001\u8de8\u5e73\u53f0\u7684\u97f3\u9891\u548c\u89c6\u9891\u5f55\u5236\u3001\u8f6c\u6362\u548c\u6d41\u5a92\u4f53\u89e3\u51b3\u65b9\u6848\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u672c\u6587\u4e2d\u9ed8\u8ba4\u73af\u5883\u4e3a macOS\u3002 \u5176\u4ed6\u7cfb\u7edf\u53ef\u80fd\u9700\u8981\u66ff\u6362\u5bf9\u5e94\u7f16\u7801\u3002")),(0,a.kt)("h2",{id:"\u5b89\u88c5"},"\u5b89\u88c5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"brew install ffmpeg\n")),(0,a.kt)("h2",{id:"\u57fa\u672c\u4f7f\u7528"},"\u57fa\u672c\u4f7f\u7528"),(0,a.kt)("p",null,"\u6700\u57fa\u672c\u7684\u683c\u5f0f\u8f6c\u6362\uff0c\u53ea\u9700\u8981\u6307\u5b9a input, output\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"ffmpeg -i input.avi output.mp4\n")),(0,a.kt)("h2",{id:"\u67e5\u770b\u89c6\u9891\u7f16\u7801"},"\u67e5\u770b\u89c6\u9891\u7f16\u7801"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# \u89c6\u9891\u7f16\u7801\nffprobe -v error -show_entries stream=codec_name -of default=noprint_wrappers=1:nokey=1 input.mp4\n\n# \u97f3\u9891\u7f16\u7801\nffprobe -v error -select_streams a:0 -show_entries stream=codec_name -of default=nokey=1:noprint_wrappers=1 input.mp4\n\n# \u5168\u90e8\u4fe1\u606f\nffprobe -hide_banner -stats -i input.mp4\n")),(0,a.kt)("h2",{id:"\u5c06\u89c6\u9891\u8f6c\u5316\u4e3a-h265-\u7f16\u7801"},"\u5c06\u89c6\u9891\u8f6c\u5316\u4e3a h265 \u7f16\u7801"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"h265")," \u7f16\u7801\u80fd\u591f\u5927\u5927\u51cf\u5c0f\u6587\u4ef6\u4f53\u79ef\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"ffmpeg -i input.mp4 -c:v libx265 -tag:v hvc1 output-h265.mp4\n")),(0,a.kt)("p",null,"\u5176\u4e2d"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"-c:v libx265")," \u6307\u5b9a\u89c6\u9891\u7f16\u7801\u4e3a ",(0,a.kt)("inlineCode",{parentName:"li"},"libx265")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"-tag:v hvc1")," \u7ed9\u89c6\u9891\u52a0\u5165 \u7f16\u7801tag\uff0c\u4fbf\u4e8e OS \u8bc6\u522b\u3002")),(0,a.kt)("p",null,"\u5728 macOS \u4e2d\uff0c\u5982\u679c\u6ca1\u6709\u5bf9\u5e94\u6807\u7b7e\uff0c\u7cfb\u7edf\u5c06\u65e0\u6cd5\u9884\u89c8\u89c6\u9891\u3002\u5982\u4e0b\u547d\u4ee4\uff0c\u53ef\u4ee5\u5feb\u901f\u7ed9\u89c6\u9891\u6dfb\u52a0tag\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"ffmpeg -i input.mp4 -vcodec copy -acodec copy -tag:v hvc1 output.mp4\n")),(0,a.kt)("p",null,"\u5176\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"-vcodec copy")," \u548c ",(0,a.kt)("inlineCode",{parentName:"p"},"-acodec copy")," \u5206\u522b\u8868\u793a\uff0c\u590d\u5236\u89c6\u9891\u3001\u97f3\u9891\u7f16\u7801\u3002\u8fd9\u6837\u80fd\u591f\u83b7\u5f97\u66f4\u5feb\u7684\u89c6\u9891\u8f6c\u6362\u901f\u5ea6\u3002"),(0,a.kt)("h2",{id:"\u65f6\u95f4"},"\u65f6\u95f4"),(0,a.kt)("p",null,"\u622a\u53d6\u4ece 66s \u5f00\u59cb\uff0c\u4e00\u517130s\u7684\u89c6\u9891\u3002\u5982\u679c\u4e0d\u6307\u5b9a ",(0,a.kt)("inlineCode",{parentName:"p"},"-t"),"\uff0c\u9ed8\u8ba4\u622a\u53d6\u5230\u89c6\u9891\u7ed3\u675f\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"ffmpeg -ss 66 -t 30 -i input.mp4 -c:v libx265 -tag:v hvc1 output.mp4\n")),(0,a.kt)("h2",{id:"\u89e3\u538b\u7f29\u89c6\u9891"},"\u89e3\u538b\u7f29\u89c6\u9891"),(0,a.kt)("p",null,"\u5728\u5bf9\u89c6\u9891\u8fdb\u884c\u5904\u7406\u65f6\uff0c\u6709\u65f6\u5019\u4f1a\u9047\u5230\u97f3\u9891\u4e22\u5e27\u7684\u7684\u60c5\u51b5\u3002\u6211\u4e2a\u4eba\u731c\u6d4b\u662f\u7531\u4e8e\u5e27\u95f4\u538b\u7f29\u5f15\u8d77\u7684\u3002\u4e0b\u9762\u7684\u547d\u4ee4\u5c06\u89c6\u9891\u3001\u97f3\u9891\u7f16\u7801\u7686\u8f6c\u5316\u4e3a raw \u683c\u5f0f\uff0c\u8fd8\u539f\u5e27\u95f4\u538b\u7f29\uff0c\u80fd\u591f\u9884\u9632\u4e0b\u4e00\u6b65\u5904\u7406\u65f6\u51fa\u9519\u3002",(0,a.kt)("br",{parentName:"p"}),"\n","\u5176\u4e2d\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"-y")," \u8868\u793a\u5bf9\u540e\u7eed\u5f39\u51fa\u63d0\u793a\u4e00\u5f8b\u9ed8\u8ba4 ",(0,a.kt)("inlineCode",{parentName:"p"},"yes"),"\u3002\u6bd4\u5982\u662f\u5426\u8986\u76d6\u73b0\u6709\u6587\u4ef6\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"ffmpeg -i input.mp4 -acodec pcm_s16le -vcodec rawvideo -y output.avi\n")),(0,a.kt)("h2",{id:"\u8c03\u6574\u5206\u8fa8\u7387"},"\u8c03\u6574\u5206\u8fa8\u7387"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"-s")," \u540e\u63a5\u53c2\u6570 ",(0,a.kt)("inlineCode",{parentName:"p"},"width"),"x",(0,a.kt)("inlineCode",{parentName:"p"},"height")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"ffmpeg  -i input.mp4 -s 480x320 output.mp4\n")),(0,a.kt)("h2",{id:"\u89c6\u9891\u5904\u7406"},"\u89c6\u9891\u5904\u7406"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"-filter:v")," \u4e3a\u89c6\u9891\u8fc7\u6ee4\u5668\uff0c\u53ef\u4ee5\u5bf9\u89c6\u9891\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u5904\u7406\u3002",(0,a.kt)("inlineCode",{parentName:"p"},"-vf")," \u4e3a\u5176\u7f29\u5199\u3002",(0,a.kt)("br",{parentName:"p"}),"\n","\u4ee5\u4e0b\u547d\u4ee4\u4e3a\u5c06\u89c6\u9891\u8f6c\u6362\u4e3a 240*320 \u5206\u8fa8\u7387\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"ffmpeg -i input.mp4 -vf scale='240:320':force_original_aspect_ratio=increase,crop='240:320' output.mp4\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"force_original_aspect_ratio"),"\uff1a\u4fdd\u6301\u89c6\u9891\u5bbd\u9ad8\u6bd4\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u503c\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"disable\u2014\u2014\u4e0d\u4fdd\u6301\u5bbd\u9ad8\u6bd4\uff1b"),(0,a.kt)("li",{parentName:"ul"},"decrease\u2014\u2014\u9700\u8981\u7684\u65f6\u5019\u964d\u4f4e\u5bbd\u6216\u8005\u9ad8\uff1b"),(0,a.kt)("li",{parentName:"ul"},"increase\u2014\u2014\u9700\u8981\u7684\u65f6\u5019\u63d0\u9ad8\u5bbd\u6216\u8005\u9ad8\u3002")),(0,a.kt)("h2",{id:"\u4f7f\u7528\u663e\u5361\u5904\u7406"},"\u4f7f\u7528\u663e\u5361\u5904\u7406"),(0,a.kt)("p",null,"\u4f7f\u7528 GPU \u786c\u4ef6\u52a0\u901f\u540e\u57fa\u672c\u4e0d\u4f1a\u6709 CPU \u5360\u7528, \u901f\u5ea6\u4f1a\u5f88\u5feb\uff0c\u4f46\u662f\u538b\u7f29\u7387\u6bd4\u8f83\u5dee\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"ffmpeg -hwaccel videotoolbox -i input.mp4 -c:v hevc_videotoolbox -b:v 6000K  -tag:v hvc1 output.mp4\n")),(0,a.kt)("p",null,"\u5176\u4e2d  "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"-hwaccel videotoolbox")," \u8868\u793a\u4f7f\u7528 macOS \u7684 videotoolbox \u786c\u4ef6\u7f16\u7801\u5668"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"hevc_videotoolbox")," \u8868\u793a\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"li"},"hevc")," (h265) \u7f16\u7801\u5668,  ",(0,a.kt)("inlineCode",{parentName:"li"},"h264")," \u4e3a ",(0,a.kt)("inlineCode",{parentName:"li"},"h264_videotoolbox")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"-b:v")," \u6307\u5b9a\u76ee\u6807\u89c6\u9891\u7801\u7387, \u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c 13M, 6000K \u4e4b\u7c7b\u7684\u503c\u3002 \u4f7f\u7528 GPU \u8fdb\u884c\u7f16\u7801\u8c8c\u4f3c\u4f1a\u4ee4 -crf \u53c2\u6570\u65e0\u6548, \u5982\u679c\u4e0d\u6307\u5b9a\u7801\u7387\u7684\u8bdd, \u89c6\u9891\u753b\u8d28\u5c06\u4f1a\u60e8\u4e0d\u5fcd\u7779.")))}d.isMDXComponent=!0}}]);